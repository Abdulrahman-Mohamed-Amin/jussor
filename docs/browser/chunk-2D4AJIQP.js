import{a as R}from"./chunk-2XW2MP6K.js";import{b as O,c,d as I,e as V,f as k,g as p,h as q,i as z,j,p as G}from"./chunk-AHL2T5OC.js";import{h as $}from"./chunk-ALSJUT2Y.js";import{Db as P,Fb as y,Ha as g,Ka as w,Oa as _,Pa as S,Qa as T,Ra as M,Sa as i,Ta as n,Ua as F,X as b,Xa as v,Za as d,_a as m,cb as r,db as x,ea as f,eb as A,fa as h,gb as D,hb as N,sa as E,va as s,wa as C}from"./chunk-I526DBKW.js";var Y=u=>({edit_form:u}),Z=u=>({active:u});function H(u,e){if(u&1){let t=v();i(0,"i",25),d("click",function(){f(t);let l=m();return h(l.closeForm())}),n()}}function J(u,e){if(u&1&&(i(0,"div",17),r(1),n()),u&2){let t=m();s(),x(t.errorMessage)}}function K(u,e){if(u&1){let t=v();i(0,"div",26)(1,"h4",27),r(2,"\u0635\u0648\u0631 \u0627\u0644\u062E\u0628\u0631"),n(),i(3,"div",28)(4,"div",29),F(5,"i",30),i(6,"img",31),d("click",function(){f(t);let l=m(2);return h(l.show(l.selectedNews.imagePaths[0]))}),n()()()()}if(u&2){let t=m(2);s(4),w("ngClass",N(2,Z,t.selectedImgeToDelete)),s(2),w("src","https://realstatesaudi.runasp.net"+t.selectedNews.imagePaths[0],E)}}function Q(u,e){if(u&1&&g(0,K,7,4,"div",26),u&2){let t=m();_(t.selectedNews.imagePaths.length>0&&t.isEditMode?0:-1)}}function W(u,e){u&1&&F(0,"div",21)}function X(u,e){if(u&1){let t=v();i(0,"tr")(1,"td"),r(2),n(),i(3,"td")(4,"button",32),d("click",function(){let l=f(t).$implicit,a=m();return h(a.editNew(l))}),r(5,"\u062A\u0639\u062F\u064A\u0644"),n(),i(6,"button",33),d("click",function(){let l=f(t),a=l.$implicit,L=l.$index,U=m();return h(U.deleteNew(L,a.id))}),r(7,"\u062D\u0630\u0641"),n()()()}if(u&2){let t=e.$implicit;s(2),x(t.arTitle)}}var B=class u{constructor(e,t){this._newsService=e;this.toast=t}errorMessage="";news=[];isEditMode=!1;selectedNewsId=null;selectedNews=null;videoFile=null;imageFiles=[];imgToDelete="";selectedImgeToDelete=!1;addForm=new k({arTitle:new p("",c.required),arDescription:new p("",c.required),enTitle:new p("",c.required),enDescription:new p("",c.required),videoPath:new p(null),imagePaths:new p([],c.required),ImagesToDelete:new p(null)});ngOnInit(){this.getNews()}toggleImageRequired(){let e=this.addForm.get("imagePaths");this.isEditMode?e?.clearValidators():e?.setValidators([c.required]),e?.updateValueAndValidity()}onVideoSelected(e){let t=e.target.files[0];this.videoFile=t||null}onImagesSelected(e){let t=e.target.files;this.imageFiles=[];for(let o=0;o<t.length;o++)this.imageFiles.push(t[o])}closeForm(){this.isEditMode=!1,this.addForm.reset(),this.videoFile=null,this.imageFiles=[]}show(e){this.imgToDelete=this.imgToDelete===""?e:"",this.selectedImgeToDelete=!this.selectedImgeToDelete}getNews(){this._newsService.getAllNews().subscribe(e=>{this.news=e})}addNew(){if(!this.addForm.valid){this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629");return}let e=new FormData;e.append("arTitle",this.addForm.value.arTitle),e.append("arDescription",this.addForm.value.arDescription),e.append("enTitle",this.addForm.value.enTitle),e.append("enDescription",this.addForm.value.enDescription),this.videoFile&&e.append("videoFile",this.videoFile),this.imageFiles.length>0&&this.imageFiles.forEach(t=>{e.append("imageFiles",t)}),this._newsService.addNew(e).subscribe({next:()=>this.toast.success("\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D \u2705"),error:t=>{t.status?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629\u060C \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627")},complete:()=>setTimeout(()=>window.location.reload(),1e3)})}editNew(e){this.isEditMode=!0,this.selectedNewsId=e.id,this.selectedNews=e,this.toggleImageRequired(),this.addForm.patchValue({arTitle:e.arTitle,arDescription:e.arDescription,enTitle:e.enTitle,enDescription:e.enDescription}),this.videoFile=null,this.imageFiles=[]}updateNew(){if(!this.selectedNewsId){this.toast.error("\u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u062F\u064A\u062F \u0627\u0644\u062E\u0628\u0631");return}let e=this.addForm.get("imagePaths");if(this.imgToDelete!==""&&e?.setValidators([c.required]),e?.updateValueAndValidity(),!this.addForm.valid){this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629");return}let t=new FormData;t.append("id",this.selectedNewsId.toString()),t.append("arTitle",this.addForm.value.arTitle),t.append("arDescription",this.addForm.value.arDescription),t.append("enTitle",this.addForm.value.enTitle),t.append("enDescription",this.addForm.value.enDescription),this.videoFile&&t.append("videoFile",this.videoFile),this.imageFiles.length>0&&this.imageFiles.forEach(o=>{t.append("imageFiles",o)}),t.append("ImagesToDelete",this.imgToDelete),this.addForm.valid?this._newsService.editNew(this.selectedNewsId,t).subscribe({next:()=>this.toast.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D \u2705"),error:o=>{o.status===401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629\u060C \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062B")},complete:()=>setTimeout(()=>window.location.reload(),1e3)}):this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629")}deleteNew(e,t){this._newsService.deleteNew(t).subscribe({next:()=>{this.toast.success("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D \u2705"),this.news.splice(e,1)},error:o=>{o.status===401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629\u060C \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062D\u0630\u0641")},complete:()=>setTimeout(()=>location.reload(),500)})}onSubmit(){this.isEditMode?this.updateNew():this.addNew()}allowEnglishOnly(e){e.target.value=e.target.value.replace(/[^a-zA-Z0-9 ]/g,"")}allowArabicOnly(e){e.target.value=e.target.value.replace(/[^ุก-ู\s\u0621-\u064A]/g,"")}static \u0275fac=function(t){return new(t||u)(C(R),C($))};static \u0275cmp=b({type:u,selectors:[["app-news"]],standalone:!0,features:[D],decls:76,vars:10,consts:[[1,"container","first-form"],[1,"",3,"ngSubmit","formGroup","ngClass"],[1,"fas","fa-xmark","close"],[1,"row"],[1,"col-md-6","col-12"],[1,"form-group"],["for","artitle"],[1,"requierd"],["type","text","id","artitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arTitle",1,"form-control",3,"input"],["for","entitle"],["type","text","id","entitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enTitle",1,"form-control",3,"input"],["for","ardes"],["type","text","id","ardes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arDescription",1,"form-control",3,"input"],["for","endes"],["type","text","id","endes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enDescription",1,"form-control",3,"input"],["for","vedio"],["type","file","id","vedio","accept","video/*","placeholder","\u0641\u064A\u062F\u064A\u0648 \u0641\u0642\u0637","formControlName","videoPath",1,"form-control",3,"change"],[1,"text-danger","error"],["for","status"],["type","file","accept","image/*","formControlName","imagePaths","id","images",1,"form-control",3,"change"],[1,"dash_btn"],[1,"lay"],[1,"dash_table","container"],[1,"mt-5"],[1,"project-table"],[1,"fas","fa-xmark","close",3,"click"],[1,"row","gy-4"],[1,"img_delete_title"],[1,"col-4"],[1,"img_cont",3,"ngClass"],[1,"fas","fa-trash","delete"],["alt","",3,"click","src"],[1,"edit-btn",3,"click"],[1,"delete",3,"click"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"form",1),d("ngSubmit",function(){return o.onSubmit()}),g(2,H,1,0,"i",2),i(3,"h2"),r(4),n(),i(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),r(9,"\u0627\u0633\u0645 \u0627\u0644\u062E\u0628\u0631 \u0639\u0631\u0628\u064A"),i(10,"span",7),r(11,"(\u0645\u0637\u0644\u0648\u0628)"),n(),i(12,"span"),r(13,"*"),n()(),i(14,"input",8),d("input",function(a){return o.allowArabicOnly(a)}),n()()(),i(15,"div",4)(16,"div",5)(17,"label",9),r(18,"\u0627\u0633\u0645 \u0627\u0644\u062E\u0628\u0631 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(19,"span",7),r(20,"(\u0645\u0637\u0644\u0648\u0628)"),n(),i(21,"span"),r(22,"*"),n()(),i(23,"input",10),d("input",function(a){return o.allowEnglishOnly(a)}),n()()(),i(24,"div",4)(25,"div",5)(26,"label",11),r(27,"\u0648\u0635\u0641 \u0627\u0644\u062E\u0628\u0631 \u0639\u0631\u0628\u064A"),i(28,"span",7),r(29,"(\u0645\u0637\u0644\u0648\u0628)"),n(),i(30,"span"),r(31,"*"),n()(),i(32,"input",12),d("input",function(a){return o.allowArabicOnly(a)}),n()()(),i(33,"div",4)(34,"div",5)(35,"label",13),r(36,"\u0648\u0635\u0641 \u0627\u0644\u062E\u0628\u0631 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(37,"span",7),r(38,"(\u0645\u0637\u0644\u0648\u0628)"),n(),i(39,"span"),r(40,"*"),n()(),i(41,"input",14),d("input",function(a){return o.allowEnglishOnly(a)}),n()()(),i(42,"div",4)(43,"div",5)(44,"label",15),r(45,"\u0627\u062E\u062A\u0631 \u0641\u064A\u062F\u064A\u0648 "),i(46,"span"),r(47,"*"),n()(),i(48,"input",16),d("change",function(a){return o.onVideoSelected(a)}),n()(),g(49,J,2,1,"div",17),n(),i(50,"div",4)(51,"div",5)(52,"label",18),r(53,"\u0627\u062E\u062A\u0631 \u0635\u0648\u0631\u0629 \u0644\u0644\u062E\u0628\u0631"),i(54,"span",7),r(55,"(\u0645\u0637\u0644\u0648\u0628)"),n(),i(56,"span"),r(57,"*"),n()(),i(58,"input",19),d("change",function(a){return o.onImagesSelected(a)}),n()()(),g(59,Q,1,1),n(),i(60,"button",20),r(61),n()(),g(62,W,1,0,"div",21),n(),i(63,"div",22)(64,"h2",23),r(65,"\u0627\u0644\u0627\u062E\u0628\u0627\u0631 \u0627\u0644\u0645\u0648\u062C\u0648\u062F\u0629 \u0627\u0644\u0645\u0648\u062C\u0648\u062F\u0629"),n(),i(66,"table",24)(67,"thead")(68,"tr")(69,"th"),r(70,"\u0627\u0633\u0645 \u0627\u0644\u062E\u0628\u0631"),n(),i(71,"th"),r(72,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),n()()(),i(73,"tbody"),T(74,X,8,1,"tr",null,S),n()()()),t&2&&(s(),w("formGroup",o.addForm)("ngClass",N(8,Y,o.isEditMode)),s(),_(o.isEditMode?2:-1),s(2),A("",o.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"," \u062E\u0628\u0631 "),s(45),_(o.errorMessage?49:-1),s(10),_(o.selectedNews?59:-1),s(2),x(o.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"),s(),_(o.isEditMode?62:-1),s(12),M(o.news))},dependencies:[G,q,O,I,V,z,j,y,P],styles:["h2[_ngcontent-%COMP%]{color:#fff;background:var(--main);padding:5px 10px;margin:0 auto 30px;width:fit-content;border-radius:10px}.col-12[_ngcontent-%COMP%]{margin-bottom:30px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:8px;color:#333}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ccc;border-radius:6px;font-size:15px;transition:border-color .3s}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 2px #007bff1a}.error[_ngcontent-%COMP%]{font-size:12px}.edit_form[_ngcontent-%COMP%]{position:fixed;background:#fff;border-radius:15px;padding:25px;box-shadow:var(--shadow);width:90%;height:90vh;left:50%;top:50%;transform:translate(-50%,-50%);z-index:5;overflow:auto}.lay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100vh;background:#00000095;z-index:3;left:0;top:0}.close[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;color:var(--blue);font-size:25px;cursor:pointer}.img_cont[_ngcontent-%COMP%]{position:relative;transition:0}.img_cont[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px}.img_cont[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#fff;font-size:15px;width:25px;height:25px;line-height:25px;text-align:center;border-radius:50%;cursor:pointer}.img_cont.active[_ngcontent-%COMP%]{border:2px solid red}.img_cont.active[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{color:red;transform:translateY(3px)}.img_delete_title[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center;color:var(--main)}"]})};export{B as NewsComponent};
