import{a as L}from"./chunk-UYYCQ3UQ.js";import{b as P,c as d,d as V,e as k,f as N,g as m,h as q,i as z,j,p as G}from"./chunk-5PTRB7GT.js";import{h as $}from"./chunk-3AVQGZ6B.js";import{Db as y,Fb as I,Ha as v,Ka as h,Oa as _,Pa as O,Qa as w,Ra as M,Sa as i,Ta as r,Ua as C,X as E,Xa as S,Za as c,_a as p,cb as o,db as F,ea as g,eb as D,fa as f,gb as A,hb as b,sa as T,va as a,wa as x}from"./chunk-C2FQAVCM.js";var U=u=>({edit_form:u}),W=u=>({active:u});function Y(u,e){if(u&1){let t=S();i(0,"i",22),c("click",function(){g(t);let l=p();return f(l.closeForm())}),r()}}function Z(u,e){if(u&1){let t=S();i(0,"div",23)(1,"h4",24),o(2,"\u0635\u0648\u0631 \u0627\u0644\u062E\u0628\u0631"),r(),i(3,"div",25)(4,"div",26),C(5,"i",27),i(6,"img",28),c("click",function(){g(t);let l=p(2);return f(l.show(l.selectedService.imagePaths[0]))}),r()()()()}if(u&2){let t=p(2);a(4),h("ngClass",b(2,W,t.selectedImgeToDelete)),a(2),h("src","https://realstatesaudi.runasp.net"+t.selectedService.imagePaths[0],T)}}function J(u,e){if(u&1&&v(0,Z,7,4,"div",23),u&2){let t=p();_(t.selectedService.imagePaths.length>0&&t.isEditMode?0:-1)}}function K(u,e){u&1&&C(0,"div",18)}function Q(u,e){if(u&1){let t=S();i(0,"tr")(1,"td"),o(2),r(),i(3,"td")(4,"button",29),c("click",function(){let l=g(t).$implicit,s=p();return f(s.editService(l))}),o(5,"\u062A\u0639\u062F\u064A\u0644"),r(),i(6,"button",30),c("click",function(){let l=g(t),s=l.$implicit,B=l.$index,H=p();return f(H.deleteService(B,s.id))}),o(7,"\u062D\u0630\u0641"),r()()()}if(u&2){let t=e.$implicit;a(2),F(t.arTitle)}}var R=class u{constructor(e,t){this._services=e;this.toast=t}services=[];isEditMode=!1;selectedProjectId=null;videoFile=null;imageFiles=[];errorMessage="";selectedServiceId=null;selectedService=null;imgToDelete="";selectedImgeToDelete=!1;addForm=new N({arTitle:new m("",d.required),arDescription:new m("",d.required),enTitle:new m("",d.required),enDescription:new m("",d.required),VideoPath:new m(null),ImageFiles:new m([],d.required),ImagesToDelete:new m(null)});ngOnInit(){this.getServices()}toggleImageRequired(){let e=this.addForm.get("ImageFiles");this.isEditMode?e?.clearValidators():e?.setValidators([d.required]),e?.updateValueAndValidity()}onVideoSelected(e){let t=e.target.files[0];this.videoFile=t||null}onImagesSelected(e){let t=e.target.files;this.imageFiles=[];for(let n=0;n<t.length;n++)this.imageFiles.push(t[n])}closeForm(){this.isEditMode=!1,this.addForm.reset()}getServices(){this._services.getAllServices().subscribe(e=>{this.services=e,console.log(e)})}addService(){let e=new FormData;e.append("arTitle",this.addForm.value.arTitle),e.append("arDescription",this.addForm.value.arDescription),e.append("enTitle",this.addForm.value.enTitle),e.append("enDescription",this.addForm.value.enDescription),this.videoFile instanceof File&&e.append("videoFile",this.videoFile),this.imageFiles&&this.imageFiles.length>0&&this.imageFiles.forEach(t=>{e.append("imageFiles",t)}),this.addForm.valid?this._services.addService(e).subscribe({next:t=>{this.toast.success("\u062A\u0645\u062A \u0627\u0636\u0627\u0641\u0629 \u0627\u0644\u062E\u062F\u0645\u0629 \u0628\u0646\u062C\u0627\u062D")},error:t=>{t.status===401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062B")},complete:()=>{window.location.reload()}}):this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629")}editService(e){this.isEditMode=!0,this.selectedProjectId=e.id,this.toggleImageRequired(),this.addForm.patchValue({arTitle:e.arTitle,arDescription:e.arDescription,enTitle:e.enTitle,enDescription:e.enDescription}),this.selectedServiceId=e.id,this.selectedService=e,this.videoFile=null,this.imageFiles=[]}updateService(){if(!this.selectedServiceId){this.toast.error("\u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u062F\u064A\u062F \u0627\u0644\u062E\u0628\u0631");return}let e=new FormData;e.append("id",this.selectedServiceId.toString()),e.append("arTitle",this.addForm.value.arTitle),e.append("arDescription",this.addForm.value.arDescription),e.append("enTitle",this.addForm.value.enTitle),e.append("enDescription",this.addForm.value.enDescription),this.videoFile instanceof File&&e.append("videoFile",this.videoFile),this.imageFiles&&this.imageFiles.length>0&&this.imageFiles.forEach(n=>{e.append("imageFiles",n)}),e.append("ImagesToDelete",this.imgToDelete);let t=this.addForm.get("ImageFiles");this.imgToDelete!==""&&t?.setValidators([d.required]),t?.updateValueAndValidity(),this.addForm.valid?this._services.editService(this.selectedServiceId,e).subscribe({next:n=>{this.toast.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D \u2705")},error:n=>{n.status===401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062B")},complete:()=>{}}):this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629")}show(e){this.imgToDelete==""?this.imgToDelete=e:this.imgToDelete="",console.log(this.imgToDelete),this.selectedImgeToDelete=!this.selectedImgeToDelete}deleteService(e,t){this._services.deleteService(t).subscribe({next:n=>{this.toast.success("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062E\u062F\u0645\u0629 \u0628\u0646\u062C\u0627\u062D"),this.services.splice(e,1)},error:n=>{n.status==401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u064A"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623\u0623\u0634\u0646\u0627\u0621 \u0627\u0644\u062D\u0630\u0641")},complete:()=>{setTimeout(()=>{location.reload()},500)}})}onSubmit(){this.isEditMode?this.updateService():this.addService()}allowEnglishOnly(e){let t=e.target;t.value=t.value.replace(/[^a-zA-Z0-9 ]/g,"")}allowArabicOnly(e){let t=e.target;t.value=t.value.replace(/[^ุก-ู\s\u0621-\u064A]/g,"")}validateVideo(e){let t=e.target,n=t.files?.[0];if(n){let l=n.type.startsWith("video/"),s=n.size>10*1024*1024;l?s?(this.errorMessage="\u0627\u0644\u0645\u0644\u0641 \u0623\u0643\u0628\u0631 \u0645\u0646 10 \u0645\u064A\u063A\u0627\u0628\u0627\u064A\u062A",t.value=""):this.errorMessage="":(this.errorMessage="\u0627\u0644\u0645\u0644\u0641 \u064A\u062C\u0628 \u0623\u0646 \u064A\u0643\u0648\u0646 \u0641\u064A\u062F\u064A\u0648 \u0641\u0642\u0637",t.value="")}}static \u0275fac=function(t){return new(t||u)(x(L),x($))};static \u0275cmp=E({type:u,selectors:[["app-our-services"]],standalone:!0,features:[A],decls:68,vars:9,consts:[[1,"container","first-form"],[1,"",3,"ngSubmit","formGroup","ngClass"],[1,"fas","fa-xmark","close"],[1,"row"],[1,"col-md-6","col-12"],[1,"form-group"],["for","artitle"],[1,"requierd"],["type","text","id","artitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arTitle",1,"form-control",3,"input"],["for","entitle"],["type","text","id","entitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enTitle",1,"form-control",3,"input"],["for","ardes"],["type","text","id","ardes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arDescription",1,"form-control",3,"input"],["for","endes"],["type","text","id","endes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enDescription",1,"form-control",3,"input"],["for","status"],["type","file","accept","image/*","formControlName","ImageFiles","id","images",1,"form-control",3,"change"],[1,"dash_btn"],[1,"lay"],[1,"dash_table","container"],[1,"mt-5"],[1,"project-table"],[1,"fas","fa-xmark","close",3,"click"],[1,"row","gy-4"],[1,"img_delete_title"],[1,"col-4"],[1,"img_cont",3,"ngClass"],[1,"fas","fa-trash","delete"],["alt","",3,"click","src"],[1,"edit-btn",3,"click"],[1,"delete",3,"click"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"form",1),c("ngSubmit",function(){return n.onSubmit()}),v(2,Y,1,0,"i",2),i(3,"h2"),o(4),r(),i(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),o(9,"\u0627\u0633\u0645 \u0627\u0644\u062E\u062F\u0645\u0629 \u0639\u0631\u0628\u064A"),i(10,"span",7),o(11,"(\u0645\u0637\u0644\u0648\u0628)"),r(),i(12,"span"),o(13,"*"),r()(),i(14,"input",8),c("input",function(s){return n.allowArabicOnly(s)}),r()()(),i(15,"div",4)(16,"div",5)(17,"label",9),o(18,"\u0627\u0633\u0645 \u0627\u0644\u062E\u062F\u0645\u0629 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(19,"span",7),o(20,"(\u0645\u0637\u0644\u0648\u0628)"),r(),i(21,"span"),o(22,"*"),r()(),i(23,"input",10),c("input",function(s){return n.allowEnglishOnly(s)}),r()()(),i(24,"div",4)(25,"div",5)(26,"label",11),o(27,"\u0648\u0635\u0641 \u0627\u0644\u062E\u062F\u0645\u0629 \u0639\u0631\u0628\u064A"),i(28,"span",7),o(29,"(\u0645\u0637\u0644\u0648\u0628)"),r(),i(30,"span"),o(31,"*"),r()(),i(32,"input",12),c("input",function(s){return n.allowArabicOnly(s)}),r()()(),i(33,"div",4)(34,"div",5)(35,"label",13),o(36,"\u0648\u0635\u0641 \u0627\u0644\u062E\u062F\u0645\u0629 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(37,"span",7),o(38,"(\u0645\u0637\u0644\u0648\u0628)"),r(),i(39,"span"),o(40,"*"),r()(),i(41,"input",14),c("input",function(s){return n.allowEnglishOnly(s)}),r()()(),i(42,"div",4)(43,"div",5)(44,"label",15),o(45,"\u0627\u062E\u062A\u0631 \u0635\u0648\u0631\u0629 \u0627\u0644\u062E\u062F\u0645\u0629"),i(46,"span",7),o(47,"(\u0645\u0637\u0644\u0648\u0628)"),r(),i(48,"span"),o(49,"*"),r()(),i(50,"input",16),c("change",function(s){return n.onImagesSelected(s)}),r()()()(),v(51,J,1,1),i(52,"button",17),o(53),r()(),v(54,K,1,0,"div",18),r(),i(55,"div",19)(56,"h2",20),o(57,"\u0627\u0644\u062E\u062F\u0645\u0627\u062A \u0627\u0644\u0645\u0648\u062C\u0648\u062F\u0629"),r(),i(58,"table",21)(59,"thead")(60,"tr")(61,"th"),o(62,"\u0627\u0633\u0645 \u0627\u0644\u062E\u062F\u0645\u0629"),r(),i(63,"th"),o(64,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),r()()(),i(65,"tbody"),w(66,Q,8,1,"tr",null,O),r()()()),t&2&&(a(),h("formGroup",n.addForm)("ngClass",b(7,U,n.isEditMode)),a(),_(n.isEditMode?2:-1),a(2),D("",n.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"," \u062E\u062F\u0645\u0629 "),a(47),_(n.selectedService?51:-1),a(2),F(n.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"),a(),_(n.isEditMode?54:-1),a(12),M(n.services))},dependencies:[G,q,P,V,k,z,j,I,y],styles:["h2[_ngcontent-%COMP%]{color:#fff;background:var(--main);padding:5px 10px;margin:0 auto 30px;width:fit-content;border-radius:10px}.col-12[_ngcontent-%COMP%]{margin-bottom:30px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:8px;color:#333}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ccc;border-radius:6px;font-size:15px;transition:border-color .3s}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 2px #007bff1a}.error[_ngcontent-%COMP%]{font-size:12px}.edit_form[_ngcontent-%COMP%]{position:fixed;background:#fff;border-radius:15px;padding:25px;box-shadow:var(--shadow);width:90%;height:90vh;left:50%;top:50%;transform:translate(-50%,-50%);z-index:5;overflow:auto}.lay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100vh;background:#00000095;z-index:3;left:0;top:0}.close[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;color:var(--blue);font-size:25px;cursor:pointer}.img_cont[_ngcontent-%COMP%]{position:relative;transition:0}.img_cont[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px}.img_cont[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#fff;font-size:15px;width:25px;height:25px;line-height:25px;text-align:center;border-radius:50%;cursor:pointer}.img_cont.active[_ngcontent-%COMP%]{border:2px solid red}.img_cont.active[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{color:red;transform:translateY(3px)}.img_delete_title[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center;color:var(--main)}"]})};export{R as OurServicesComponent};
