import{a as L}from"./chunk-UMQ2EBKJ.js";import{a as P,b as h,c as I,d as k,e as V,f as m,g as z,h as j,i as G,o as q}from"./chunk-GYX3UYIK.js";import{h as $}from"./chunk-2NZ5WEEJ.js";import{Bb as O,Fa as f,Ia as v,Ma as _,Na as S,Oa as T,Pa as M,Qa as i,Ra as o,Sa as F,Va as w,W as b,Xa as d,Ya as c,ab as r,bb as x,ca as p,cb as D,da as g,eb as A,fb as E,qa as N,ta as a,ua as C,zb as y}from"./chunk-2KD2ZHNZ.js";var U=u=>({edit_form:u}),W=u=>({active:u});function Y(u,e){if(u&1){let t=w();i(0,"i",26),d("click",function(){p(t);let l=c();return g(l.closeForm())}),o()}}function Z(u,e){if(u&1&&(i(0,"div",17),r(1),o()),u&2){let t=c();a(),x(t.errorMessage)}}function J(u,e){if(u&1){let t=w();i(0,"div",20)(1,"h4",27),r(2,"\u0635\u0648\u0631 \u0627\u0644\u062E\u0628\u0631"),o(),i(3,"div",28)(4,"div",29),F(5,"i",30),i(6,"img",31),d("click",function(){p(t);let l=c();return g(l.show(l.selectedNews.imagePaths[0]))}),o()()()()}if(u&2){let t=c();a(4),v("ngClass",E(2,W,t.selectedImgeToDelete)),a(2),v("src","https://realstatesaudi.runasp.net"+t.selectedNews.imagePaths[0],N)}}function K(u,e){u&1&&F(0,"div",22)}function Q(u,e){if(u&1){let t=w();i(0,"tr")(1,"td"),r(2),o(),i(3,"td")(4,"button",32),d("click",function(){let l=p(t).$implicit,s=c();return g(s.editNew(l))}),r(5,"\u062A\u0639\u062F\u064A\u0644"),o(),i(6,"button",33),d("click",function(){let l=p(t),s=l.$implicit,H=l.$index,R=c();return g(R.deleteNew(H,s.id))}),r(7,"\u062D\u0630\u0641"),o()()()}if(u&2){let t=e.$implicit;a(2),x(t.arTitle)}}var B=class u{constructor(e,t){this._newsService=e;this.toast=t}errorMessage="";news=[];isEditMode=!1;selectedNewsId=null;selectedNews=null;videoFile=null;imageFiles=[];imgToDelete="";selectedImgeToDelete=!1;addForm=new V({arTitle:new m("",h.required),arDescription:new m("",h.required),enTitle:new m("",h.required),enDescription:new m("",h.required),videoPath:new m(null),imagePaths:new m([]),ImagesToDelete:new m(null)});ngOnInit(){this.getNews()}onVideoSelected(e){let t=e.target.files[0];this.videoFile=t||null}onImagesSelected(e){let t=e.target.files;this.imageFiles=[];for(let n=0;n<t.length;n++)this.imageFiles.push(t[n])}closeForm(){this.isEditMode=!1,this.addForm.reset()}getNews(){this._newsService.getAllNews().subscribe(e=>{this.news=e,console.log(e)})}addNew(){let e=new FormData;e.append("arTitle",this.addForm.value.arTitle),e.append("arDescription",this.addForm.value.arDescription),e.append("enTitle",this.addForm.value.enTitle),e.append("enDescription",this.addForm.value.enDescription),this.videoFile&&e.append("videoFile",this.videoFile),this.imageFiles.length>0&&this.imageFiles.forEach(t=>{e.append("imageFiles",t)}),this.addForm.valid?this._newsService.addNew(e).subscribe({next:t=>{},error:t=>{t.status?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627")},complete:()=>{}}):this.toast.error("\u0628\u0639\u0636 \u0627\u0644\u062D\u0642\u0648\u0644 \u0641\u0627\u0631\u063A\u0629")}editNew(e){this.isEditMode=!0,this.selectedNewsId=e.id,this.selectedNews=e,this.addForm.patchValue({arTitle:e.arTitle,arDescription:e.arDescription,enTitle:e.enTitle,enDescription:e.enDescription}),this.videoFile=null,this.imageFiles=[],console.log(this.selectedNews)}updateNew(){if(!this.selectedNewsId){this.toast.error("\u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u062F\u064A\u062F \u0627\u0644\u062E\u0628\u0631");return}let e=new FormData;e.append("id",this.selectedNewsId.toString()),e.append("arTitle",this.addForm.value.arTitle),e.append("arDescription",this.addForm.value.arDescription),e.append("enTitle",this.addForm.value.enTitle),e.append("enDescription",this.addForm.value.enDescription),this.videoFile&&e.append("videoFile",this.videoFile),this.imageFiles.length>0?this.imageFiles.forEach(n=>{e.append("imageFiles",n)}):e.append("imagePaths",this.addForm.value.imageFiles);let t=this.addForm.value.ImagesToDelete;t&&t.length>0&&t.forEach(n=>{}),console.log(t),e.append("ImagesToDelete",this.imgToDelete),this._newsService.editNew(this.selectedNewsId,e).subscribe({next:n=>{this.toast.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D \u2705")},error:n=>{n.status===401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062B")},complete:()=>{}})}show(e){this.imgToDelete==""?this.imgToDelete=e:this.imgToDelete="",console.log(this.imgToDelete),this.selectedImgeToDelete=!this.selectedImgeToDelete}deleteNew(e,t){this._newsService.deleteNew(t).subscribe({next:n=>{this.toast.success("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062E\u0628\u0631 \u0628\u0646\u062C\u0627\u062D"),this.news.splice(e,1)},error:n=>{n.status==401?this.toast.error("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0633\u062C\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u064A"):this.toast.error("\u062D\u062F\u062B \u062E\u0637\u0623\u0623\u0634\u0646\u0627\u0621 \u0627\u0644\u062D\u0630\u0641")},complete:()=>{}})}onSubmit(){this.isEditMode?this.updateNew():this.addNew()}allowEnglishOnly(e){let t=e.target;t.value=t.value.replace(/[^a-zA-Z0-9 ]/g,"")}allowArabicOnly(e){let t=e.target;t.value=t.value.replace(/[^ุก-ู\s\u0621-\u064A]/g,"")}validateVideo(e){let t=e.target,n=t.files?.[0];if(n){let l=n.type.startsWith("video/"),s=n.size>10*1024*1024;l?s?(this.errorMessage="\u0627\u0644\u0645\u0644\u0641 \u0623\u0643\u0628\u0631 \u0645\u0646 10 \u0645\u064A\u063A\u0627\u0628\u0627\u064A\u062A",t.value=""):this.errorMessage="":(this.errorMessage="\u0627\u0644\u0645\u0644\u0641 \u064A\u062C\u0628 \u0623\u0646 \u064A\u0643\u0648\u0646 \u0641\u064A\u062F\u064A\u0648 \u0641\u0642\u0637",t.value="")}}static \u0275fac=function(t){return new(t||u)(C(L),C($))};static \u0275cmp=b({type:u,selectors:[["app-news"]],standalone:!0,features:[A],decls:76,vars:10,consts:[[1,"container","first-form"],[1,"",3,"ngSubmit","formGroup","ngClass"],[1,"fas","fa-xmark","close"],[1,"row"],[1,"col-md-6","col-12"],[1,"form-group"],["for","artitle"],[1,"requierd"],["type","text","id","artitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arTitle",1,"form-control",3,"input"],["for","entitle"],["type","text","id","entitle","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enTitle",1,"form-control",3,"input"],["for","ardes"],["type","text","id","ardes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0641\u0642\u0637","formControlName","arDescription",1,"form-control",3,"input"],["for","endes"],["type","text","id","endes","placeholder","\u0627\u0644\u0627\u062F\u062E\u0627\u0644 \u0628\u0627\u0644\u0644\u063A\u0629 \u0627\u0644\u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629 \u0641\u0642\u0637","formControlName","enDescription",1,"form-control",3,"input"],["for","vedio"],["type","file","id","vedio","placeholder","\u0641\u064A\u062F\u064A\u0648 \u0641\u0642\u0637","formControlName","videoPath",1,"form-control",3,"change"],[1,"text-danger","error"],["for","status"],["type","file","accept","image/*","formControlName","imagePaths","id","images",1,"form-control",3,"change"],[1,"row","gy-4"],[1,"dash_btn"],[1,"lay"],[1,"dash_table","container"],[1,"mt-5"],[1,"project-table"],[1,"fas","fa-xmark","close",3,"click"],[1,"img_delete_title"],[1,"col-4"],[1,"img_cont",3,"ngClass"],[1,"fas","fa-trash","delete"],["alt","",3,"click","src"],[1,"edit-btn",3,"click"],[1,"delete",3,"click"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"form",1),d("ngSubmit",function(){return n.onSubmit()}),f(2,Y,1,0,"i",2),i(3,"h2"),r(4),o(),i(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),r(9,"\u0627\u0633\u0645 \u0627\u0644\u062E\u0628\u0631 \u0639\u0631\u0628\u064A"),i(10,"span",7),r(11,"(\u0645\u0637\u0644\u0648\u0628)"),o(),i(12,"span"),r(13,"*"),o()(),i(14,"input",8),d("input",function(s){return n.allowArabicOnly(s)}),o()()(),i(15,"div",4)(16,"div",5)(17,"label",9),r(18,"\u0627\u0633\u0645 \u0627\u0644\u062E\u0628\u0631 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(19,"span",7),r(20,"(\u0645\u0637\u0644\u0648\u0628)"),o(),i(21,"span"),r(22,"*"),o()(),i(23,"input",10),d("input",function(s){return n.allowEnglishOnly(s)}),o()()(),i(24,"div",4)(25,"div",5)(26,"label",11),r(27,"\u0648\u0635\u0641 \u0627\u0644\u062E\u0628\u0631 \u0639\u0631\u0628\u064A"),i(28,"span",7),r(29,"(\u0645\u0637\u0644\u0648\u0628)"),o(),i(30,"span"),r(31,"*"),o()(),i(32,"input",12),d("input",function(s){return n.allowArabicOnly(s)}),o()()(),i(33,"div",4)(34,"div",5)(35,"label",13),r(36,"\u0648\u0635\u0641 \u0627\u0644\u062E\u0628\u0631 \u0627\u0646\u062C\u0644\u064A\u0632\u064A"),i(37,"span",7),r(38,"(\u0645\u0637\u0644\u0648\u0628)"),o(),i(39,"span"),r(40,"*"),o()(),i(41,"input",14),d("input",function(s){return n.allowEnglishOnly(s)}),o()()(),i(42,"div",4)(43,"div",5)(44,"label",15),r(45,"\u0627\u062E\u062A\u0631 \u0641\u064A\u062F\u064A\u0648 "),i(46,"span"),r(47,"*"),o()(),i(48,"input",16),d("change",function(s){return n.onVideoSelected(s)}),o()(),f(49,Z,2,1,"div",17),o(),i(50,"div",4)(51,"div",5)(52,"label",18),r(53,"\u0627\u062E\u062A\u0631 \u0635\u0648\u0631\u0629 \u0644\u0644\u062E\u0628\u0631"),i(54,"span",7),r(55,"(\u0645\u0637\u0644\u0648\u0628)"),o(),i(56,"span"),r(57,"*"),o()(),i(58,"input",19),d("change",function(s){return n.onImagesSelected(s)}),o()()(),f(59,J,7,4,"div",20),o(),i(60,"button",21),r(61),o()(),f(62,K,1,0,"div",22),o(),i(63,"div",23)(64,"h2",24),r(65,"\u0627\u0644\u062E\u062F\u0645\u0627\u062A \u0627\u0644\u0645\u0648\u062C\u0648\u062F\u0629"),o(),i(66,"table",25)(67,"thead")(68,"tr")(69,"th"),r(70,"\u0627\u0633\u0645 \u0627\u0644\u062E\u062F\u0645\u0629"),o(),i(71,"th"),r(72,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),o()()(),i(73,"tbody"),T(74,Q,8,1,"tr",null,S),o()()()),t&2&&(a(),v("formGroup",n.addForm)("ngClass",E(8,U,n.isEditMode)),a(),_(n.isEditMode?2:-1),a(2),D("",n.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"," \u062E\u0628\u0631 "),a(45),_(n.errorMessage?49:-1),a(10),_(n.selectedNews&&n.isEditMode?59:-1),a(2),x(n.isEditMode?"\u062A\u0639\u062F\u064A\u0644":"\u0625\u0636\u0627\u0641\u0629"),a(),_(n.isEditMode?62:-1),a(12),M(n.news))},dependencies:[q,z,P,I,k,j,G,O,y],styles:["h2[_ngcontent-%COMP%]{color:#fff;background:var(--main);padding:5px 10px;margin:0 auto 30px;width:fit-content;border-radius:10px}.col-12[_ngcontent-%COMP%]{margin-bottom:30px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:8px;color:#333}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ccc;border-radius:6px;font-size:15px;transition:border-color .3s}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 2px #007bff1a}.error[_ngcontent-%COMP%]{font-size:12px}.edit_form[_ngcontent-%COMP%]{position:fixed;background:#fff;border-radius:15px;padding:25px;box-shadow:var(--shadow);width:90%;height:90vh;left:50%;top:50%;transform:translate(-50%,-50%);z-index:5;overflow:auto}.lay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100vh;background:#00000095;z-index:3;left:0;top:0}.close[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;color:var(--blue);font-size:25px;cursor:pointer}.img_cont[_ngcontent-%COMP%]{position:relative;transition:0}.img_cont[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px}.img_cont[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#fff;font-size:15px;width:25px;height:25px;line-height:25px;text-align:center;border-radius:50%;cursor:pointer}.img_cont.active[_ngcontent-%COMP%]{border:2px solid red}.img_cont.active[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{color:red;transform:translateY(3px)}.img_delete_title[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center;color:var(--main)}"]})};export{B as NewsComponent};
